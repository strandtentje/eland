{
	self = f"skelet.conf@on";
	quiet = StubService();
	checkpermission = f"perm/ission.conf@check";	

	messages = {
		denied = <self> {
			content->Template(f"templates/accessdenied.html");
		};

		loggedout = <self> {
			content->Template(f"templates/loggedout.html");
		};	
	};
	
	instances = {
		on = Template(f"templates/skelet.html") {
			style->Template(f"styles/swag.css");
			register-><checkpermission>(resource = "self", action = "create") {
				denied->quiet;
				granted->Template(f"templates/registerlink.html");
			};
			logout-><checkpermission>(resource = "session", action = "delete") {
				denied->quiet;
				granted->Template(f"templates/logoutlink.html");
			};
			login-><checkpermission>(resource = "session", action = "create") {
				denied->quiet;
				granted->Template(f"templates/loginlink.html");
			};
			self-><checkpermission>(resource = "self", action = "modify") {
				denied->quiet;
				granted->Template(f"templates/selflink.html");
			};
			admin-><checkpermission>(resource = "user", action = "admin") {
				denied->quiet;
				granted->Template(f"templates/adminlink.html");
			};
			team-><checkpermission>(resource = "ownteam", action = "view") {
				denied->quiet;
				granted->Template(f"templates/teamlink.html");
			};
			content->Return("content");
		};

		logout = <checkpermission>(resource = "session", action = "delete") {			
			granted-><f"login/auth.conf@end"> {
				ended->messages.loggedout;
			};
		};
	};
}